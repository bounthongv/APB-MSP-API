Here is the guide to set it up on the Ubuntu server:

  1. Upload the Service File
  Upload the apb_api.service file you just created to the server (e.g., using SFTP or SCP) and move it to /etc/systemd/system/.

  On the server:
   1 mv apb_api.service /etc/systemd/system/

  2. Install Dependencies (on Server)
  Ensure waitress and other requirements are installed:
   1 cd /root/apb_api
   2 pip install -r requirements.txt

  3. Start the Service
  Run these commands on the server to enable and start the API:

   1 # Reload systemd to see the new file
   2 systemctl daemon-reload
   3 
   4 # Start the service
   5 systemctl start apb_api
   6 
   7 # Enable it to start on boot
   8 systemctl enable apb_api

  4. Check Status
  Verify it's running:

   1 systemctl status apb_api
  You should see Active: active (running).

## Service without source code (PyInstaller)

If you do not want to share the source code with the customer, you can compile the application into a standalone executable using **PyInstaller**.

### 1. Build the Executable
Run the following command in your development environment (must be the same OS as the server, e.g., Ubuntu):

```bash
pip install pyinstaller
pyinstaller --onefile --name apb_api api.py
```

This generates a single executable file in `dist/apb_api`.

### 2. Deploy
Copy only the `dist/apb_api` file and your `.env` file to the server folder (e.g., `/root/apb_api`). You do not need the `.py` files.

### 3. Update Service File
Update your `apb_api.service` to run the executable directly instead of using Python.

**Updated `apb_api.service`:**

```ini
[Unit]
Description=APB API Service (Compiled)
After=network.target

[Service]
User=root
# Set the working directory to where the .env file is located
WorkingDirectory=/root/apb_api
# Point directly to the compiled executable
ExecStart=/root/apb_api/apb_api
Restart=always

[Install]
WantedBy=multi-user.target
```